name: Kirim WhatsApp via Wablas

on:
  workflow_dispatch:
    inputs:
      phone:
        description: 'Nomor tujuan (628xxx)'
        required: true
      message:
        description: 'Isi pesan'
        required: true

env:
  WABLAS_TOKEN: ${{ secrets.jaFCEOPupjtkuyp4Ue5wLxfauy3P09OhRzhmIG3JnLFOMN3L9yWDG4s }}
  WABLAS_SECRET: ${{ secrets.V9ZDhmRP }}

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - name: Kirim pesan WhatsApp
        run: |
          echo "Mengirim ke: ${{ github.event.inputs.phone }}"
          echo "Pesan: ${{ github.event.inputs.message }}"
          curl --request POST 'https://tegal.wablas.com/api/v2/send-message' \
          --header 'Content-Type: application/x-www-form-urlencoded' \
          --data-urlencode "phone=${{ github.event.inputs.phone }}" \
          --data-urlencode "message=${{ github.event.inputs.message }}" \
          --data-urlencode "token=$WABLAS_TOKEN" \
          --data-urlencode "secret=$WABLAS_SECRET" \
          --silent --show-error --fail
